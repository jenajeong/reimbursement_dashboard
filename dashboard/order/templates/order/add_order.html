<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>주문 추가</title>
    <link rel="stylesheet" href="../../../static/css/order/add_order.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <nav class="sidebar-nav">
                <div style="font-size: 1.5em; font-weight: 700; margin-bottom: 40px; color: #007bff;">Wise Music Dashboard</div>
                <a href="{% url 'order_list' %}" class="nav-item">주문 목록</a>
                <a href="-" class="nav-item active">주문 추가</a>
                <a href="#" class="nav-item">책 관리</a>
                <a href="#" class="nav-item">정산 관리</a>
            </nav>
        </div>

        <main class="content">
            <h2 class="page-title">새로운 주문 추가</h2>
            
            <div class="add-order-form">
                
                <!-- 모달 헤더를 페이지 헤더로 재사용 -->
                <div class="modal-header-layout">
                    <h2 class="modal-title">주문 정보 입력</h2>
                    <!-- 주문 저장 버튼 (폼 외부에서 폼 제출) -->
                    <button class="save-button" type="submit" form="add-order-form">주문 저장</button>
                </div>

                <!-- 주문 추가 폼 (HTMX POST 요청) -->
                <form id="add-order-form" hx-post="{% url 'add_order' %}" hx-swap="none">
                    
                    <!-- ================================== 상품 정보 섹션 ================================== -->
                    <fieldset class="form-fieldset">
                        <legend class="fieldset-legend">상품 정보</legend>

                        <!-- 상품명 검색 필드 -->
                        <div class="form-row-group">
                            <div class="form-label">상품명</div>
                            <input type="text" name="item_name" placeholder="상품명 또는 ISBN 검색" required class="form-input">
                            <button type="button" class="search-btn">검색</button>
                        </div>

                        <!-- 현재 선택된 상품 (임시 태그) -->
                        <div class="form-row-group selected-items-row">
                            <div class="form-label"></div>
                            <div class="selected-items-container">
                                <span class="item-tag">
                                    X 와이즈조성가 1... (1)
                                </span>
                                <!-- 다른 상품 태그가 여기에 추가될 수 있음 -->
                            </div>
                        </div>

                        <!-- 수량 & 할인율 -->
                        <div class="form-row-group margin-top-20">
                            <div class="form-label">수량 & 할인율</div>
                            <input type="number" name="quantity" min="1" value="1" required class="form-input quantity-input">
                            <select name="discount_rate" class="form-select discount-select">
                                <option value="0">할인율 선택 (0%)</option>
                                <option value="5">5% 할인</option>
                                <option value="10">10% 할인</option>
                            </select>
                        </div>
                        
                        <!-- 추가 상품 -->
                        <div class="form-row-group">
                            <div class="form-label">추가상품</div>
                            <select name="additional_item" class="form-select full-width-select">
                                <option value="">추가 상품 없음</option>
                                <option value="gift_wrap">선물 포장</option>
                            </select>
                        </div>

                        <!-- 공급가 -->
                        <div class="form-row-group">
                            <div class="form-label">공급가</div>
                            <input type="number" name="supply_price" min="0" placeholder="자동 계산 또는 직접 입력" class="form-input full-width-input">
                        </div>
                    </fieldset>
                    
                    <!-- ================================== 배송 정보 섹션 ================================== -->
                    <fieldset class="form-fieldset">
                        <legend class="fieldset-legend">배송 정보</legend>

                        <!-- 주문자명 -->
                        <div class="form-row-group">
                            <div class="form-label">주문자명</div>
                            <input type="text" name="customer_name" required class="form-input full-width-input">
                        </div>

                        <!-- 주소 -->
                        <div class="form-row-group">
                            <div class="form-label">주소</div>
                            <select name="address" class="form-select full-width-select">
                                <option value="">기본 배송지 선택 또는 새 주소 입력</option>
                            </select>
                        </div>
                        
                        <!-- 연락처 -->
                        <div class="form-row-group">
                            <div class="form-label">연락처</div>
                            <input type="text" name="contact" placeholder="010-XXXX-XXXX" required class="form-input full-width-input">
                        </div>

                        <!-- 주문일 & 배송일 -->
                        <div class="form-row-group date-row">
                            <div class="form-label">주문일 & 배송일</div>
                            <input type="date" name="order_date" required class="form-input date-input-half">
                            <input type="date" name="shipping_date" class="form-input date-input-half date-input-margin">
                        </div>

                        <!-- 주문처 & 배송방법 -->
                        <div class="form-row-group split-row">
                            <div class="form-label">주문처 & 배송방법</div>
                            <select name="order_source" required class="form-select select-half">
                                <option value="website">웹사이트</option>
                                <option value="phone">전화</option>
                                <option value="store">매장</option>
                            </select>
                            <select name="shipping_method" class="form-select select-half select-margin">
                                <option value="택배">택배</option>
                                <option value="방문수령">방문 수령</option>
                            </select>
                        </div>

                        <!-- 요청사항 -->
                        <div class="form-row-group textarea-row">
                            <div class="form-label textarea-label">요청사항</div>
                            <textarea name="request_memo" rows="4" class="form-input textarea-input"></textarea>
                        </div>
                        
                    </fieldset>

                    <!-- 폼 제출 영역과 분리된 하단 취소 버튼 -->
                    <div class="button-group-bottom">
                        <a href="{% url 'order_list' %}" class="cancel-button" style="text-decoration: none;">취소 및 목록으로</a>
                    </div>

                </form>
            </div>
        </main>
    </div>
    
    <script>
        // 이 페이지에는 별도의 JS 유효성 검사 (예: 날짜 비교)는 필요하지 않으나, 
        // 폼 제출 후 페이지 이동 등을 구현할 때 사용 가능.
    </script>
</body>
</html>
